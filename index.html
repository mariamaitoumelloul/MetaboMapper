<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Metabolite Label Harmonization Tool • MetaboMapper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Metabolite Label Harmonization Tool">
<meta property="og:description" content="A package designed for metabolite label matching, offering functions to map names or identifiers (e.g., HMDB, KEGG, CHEBI, INCHIKEY) to standardized HMDB identifiers. This facilitates the integration of datasets from diverse studies with varying annotations.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">MetaboMapper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mariamaitoumelloul/MetaboMapper/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="metamapper-documentation">MetaMapper Documentation<a class="anchor" aria-label="anchor" href="#metamapper-documentation"></a>
</h1></div>
<p>MetaMapper is an R package developed to connect metabolite names and IDs from various metabolomic studies to HMDB identifiers, enabling cross-study comparisons. The package currently supports mapping the following types of identifiers to HMDB:</p>
<ul>
<li>Metabolite name<br>
</li>
<li>HMDB ID<br>
</li>
<li>INCHIKEY<br>
</li>
<li>KEGG ID<br>
</li>
<li>CHEBI ID</li>
</ul>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>```{r} #Install devtools in R install.packages(“devtools”)</p>
<p>#Install MetaboMapper package install_github(“mariamaitoumelloul/MetaboMapper”)</p>
<pre><code>
# Building the Reference from HMDB

To build the reference file, you first need to download the metabolites dataset in XML format from the [HMDB official website](https://hmdb.ca/downloads). We recommend downloading the "All metabolites" dataset.

Once downloaded, you can build the reference dataset by running the `hmdbextract` function provided by the package as follows:

```{r}
# Replace 'path_to_xml' with the actual path to your XML file downloaded from the HMDB database
path_to_xml &lt;- "data/all_metabolites.xml"

# Run the function to create the reference dataset
df_reference &lt;- hmdbextract(path_to_xml)</code></pre>
<p>This step needs to be done only once for each new XML document. Once the reference file is generated, it can be reused across different studies or projects.</p>
</div>
<div class="section level1">
<h1 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h1>
<p>Now that you have the reference dataset, you can use it to map any of the following identifiers to HMDB identifiers:</p>
<ul>
<li>
<strong>Name</strong>: The function compares the metabolite name from your study with the names and synonyms listed in the HMDB database to find matches.</li>
<li>
<strong>HMDB</strong>: A metabolite may have multiple HMDB IDs (secondary accessions). The function ensures that the HMDB ID in your study is mapped to all versions of the HMDB IDs in the database.</li>
<li>
<strong>INCHIKEY</strong>: The INCHIKEY in your study is processed to extract both the skeleton (base) and the complete key (without the version number), which are then matched to the INCHIKEY in the HMDB database. Note that matching the INCHIKEY skeleton has a lower confidence score than the full version, as it ignores various forms of isomerism (stereo, tautomeric, etc.).</li>
<li>
<strong>Other IDs</strong>: The function can also map KEGG and CHEBI IDs to those available in the HMDB database.</li>
</ul>
<div class="section level3">
<h3 id="input-requirements">Input Requirements<a class="anchor" aria-label="anchor" href="#input-requirements"></a>
</h3>
<p>To perform the mapping, the following inputs are required: 1. <strong>Reference DataFrame</strong>: The reference dataset generated in the previous step. For more details, refer to the <a href="#building-the-reference-from-hmdb">Building the Reference from HMDB</a> section. 2. <strong>Study DataFrame</strong>: Your study data, which must include at least one column with metabolite names. Additional columns with related identifiers can also be included. 3. <strong>Identifiers</strong>: This parameter specifies which type of identifier you want to use for mapping. Acceptable values are: <code>NAME</code>, <code>INCHIKEY</code>, <code>HMDB</code>, <code>KEGG</code>, or <code>CHEBI</code>.</p>
<p>Notes The details parameter in the function controls the level of information returned: - If details = <code>TRUE</code>, additional information about the mapping process (e.g., synonyms matched, intermediate steps) will be included in the output. - If details = <code>FALSE</code>, only the essential mapped data is returned. Always ensure that your df_reference and df_study DataFrames are formatted correctly before running the MetaboMap function to avoid errors.</p>
<p>The function may take a few seconds (&lt;2 minutes) to run, especially when using “NAME” as the identifier to map.</p>
</div>
<div class="section level3">
<h3 id="example-map-one-identifier-at-a-time">Example: Map One Identifier at a Time<a class="anchor" aria-label="anchor" href="#example-map-one-identifier-at-a-time"></a>
</h3>
<p>Here is how to map a single identifier to HMDB:</p>
<p>```{r} # Example when only the metabolite names are provided df_study &lt;- data.frame( metabolite_name = c(“1-Methylhistidine”, “2-Ketobutyric acid”) )</p>
</div>
</div>
<div class="section level1">
<h1 id="running-the-metabomap-function-to-map-based-on-name">Running the MetaboMap function to map based on ‘NAME’<a class="anchor" aria-label="anchor" href="#running-the-metabomap-function-to-map-based-on-name"></a>
</h1>
<p>df_study_hmdb_matched &lt;- MetaboMap( df_study = df_study, study_cols = c(“metabolite_name”), identifiers = c(“NAME”), df_reference = df_reference, details = FALSE, original_colname = “metabolite_name” )</p>
<p>```{r} # Example to match based on HMDB ID df_study &lt;- data.frame( metabolite_name = c(“1-Methylhistidine”, “2-Ketobutyric acid”), HMDB_id = c(“HMDB0000001”, “HMDB0000005”) )</p>
</div>
<div class="section level1">
<h1 id="running-the-metabomap-function-to-map-based-on-hmdb">Running the MetaboMap function to map based on ‘HMDB’<a class="anchor" aria-label="anchor" href="#running-the-metabomap-function-to-map-based-on-hmdb"></a>
</h1>
<p>df_study_hmdb_matched &lt;- MetaboMap( df_study = df_study, study_cols = c(“HMDB_id”), identifiers = c(“HMDB”), df_reference = df_reference, details = FALSE, original_colname = “metabolite_name” )</p>
<pre><code>
### Expected Output
The resulting DataFrame will include the following columns:

- Original metabolite name: The metabolite name as provided in your study.
- HMDB_label and HMDB_id: These columns contain the HMDB identifiers mapped from your input data. These can be used as references in future steps for matching with other studies.
- Confidence level: A confidence level is assigned to each match, depending on the identifier used:
For most identifiers (NAME, HMDB, KEGG, CHEBI), the confidence level is 3.
For INCHIKEY skeleton matches, the confidence level is 2, as this type of match ignores stereochemistry and other forms of isomerism.

### Example: Map Multiple Identifiers at a Time

If you need to map multiple identifiers simultaneously, ensure the order of study_cols and identifiers is consistent:

```{r}
# Example to map both HMDB ID and metabolite name
df_study &lt;- data.frame(
  metabolite_name = c("1-Methylhistidine", "2-Ketobutyric acid"),
  HMDB_id = c("HMDB0000001", "HMDB0000005")
)

# Running the MetaboMap function to map based on both 'HMDB' and 'NAME'
df_study_hmdb_matched &lt;- MetaboMap(
  df_study = df_study,
  study_cols = c("HMDB_id", "metabolite_name"),
  identifiers = c("HMDB", "NAME"),
  df_reference = df_reference,
  details = FALSE,
  original_colname = "metabolite_name"
)</code></pre>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mariamaitoumelloul/MetaboMapper/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mariamaitoumelloul/MetaboMapper/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MetaboMapper</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>The package maintainer <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
